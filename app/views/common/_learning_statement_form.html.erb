<%#
Renders a form for a new learning outcome or a prerequisite.
params:
  form_name: 'event' or 'material'
  statement: the learning_outcome or prerequisite object
  statement_type: 'learning_outcome' or 'prerequisite'
%>
<% css_statement_type = statement_type.split("_").join("-").pluralize %>
<% index ||= 'replace-me' %> <%# This is so we can render a blank version of this sub-form in the page, %>

<%# which can be dynamically cloned using JavaScript to add more ExternalResources to the main material form %>
<% field_name_prefix = "#{form_name}[#{statement_type.pluralize}_attributes][#{index}]" %>
<% field_id_prefix_verb = "#{form_name}_#{statement_type.pluralize}_attributes_verb_#{index}" %>
<% field_id_prefix_topic = "#{form_name}_#{statement_type.pluralize}_attributes_noun_#{index}" %>
<% field_id_prefix_tool = "#{form_name}_#{statement_type.pluralize}_attributes_tool_#{index}" %>

<div class="form-inline learning-statement-form <%=css_statement_type%>-form" data-index="<%= index -%>" data-form-type="<%= form_name %>">

  <%= hidden_field_tag("#{field_name_prefix}[id]", statement.id) %>

  <!-- TODO: Replace with Choices.js -->
  <div class="form-group">
      Verb:
      <%= select_tag "#{field_name_prefix}[verb]",
                     options_for_select(VerbDictionary.instance.options_for_select, ''),
                     id: "#{field_id_prefix_verb}",
                     :include_blank => true,
                     data: {
                         "hidden-id": "#{form_name}_#{statement_type.pluralize}_attributes_#{index}_verb"
                     }

      %>
    <%= hidden_field_tag("#{field_name_prefix}[verb]", statement.verb) %>
  </div>
  <br>
  <div class="form-group">
    Activity:
    <%= tag :div, name: "#{field_name_prefix}[noun]", id: "#{field_id_prefix_topic}" -%>
  </div><!--For some reason the above tag does not close, so we need to add an extra </div> tag here...-->

  <!-- hidden form field for storing selected ontology terms -->
  <%= hidden_field_tag("#{field_name_prefix}[noun]", statement.noun) %>
</div>

<br>

<div class="form-group">
  Using:
  <div class="learning-statement-tool">
    <select
            data-hidden-id="<%= "#{form_name}_#{statement_type.pluralize}_attributes_#{index}_tool"-%>"
            id="<%=field_id_prefix_tool%>"
            placeholder="This is a placeholder"
            data-lpignore="true">
    </select>
    <%= hidden_field_tag("#{field_name_prefix}[tool_id]", statement.tool_id) %>
    <%= hidden_field_tag("#{field_name_prefix}[tool_name]", statement.tool_name) %>
  </div>
</div>


<label class="delete-learning-statement-btn ">
  &times;
  <%= hidden_field_tag "#{field_name_prefix}[_destroy]", '0', :autocomplete => 'off' %>
  <%= check_box_tag "#{field_name_prefix}[_destroy]", '1', false, :class => 'destroy-attribute', :autocomplete => 'off' %>
</label>
</div>
